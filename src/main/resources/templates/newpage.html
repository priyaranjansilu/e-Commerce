<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Shopping website</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300&display=swap" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/homedeli.css}">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">

</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo"><a href="#"><img th:src="@{/img/7835563.png}" alt=""></a></div>
            <div id="searchbar">
                <input type="text" id="search-bar" placeholder="Search for a product..." onkeyup="filterItems()">
                <button name="search">search</button>
            </div>
			<span style="padding-top: 20px;" id="username"></span>
            <div id="cart"><i class="fa-solid fa-user"></i></div>
        </div>
        <sidebar id="classFilter">
           <div class="filterHeader">CATEGORY</div>
            <div class="filterItem" id="smartphonebtn" onclick="addFilter(this.id, 'smartphone');">Smartphones</div>
            <div class="filterItem" id="laptop" onclick="addFilter(this.id, 'laptop');">Laptops</div>
            <div class="filterItem" id="desktop" onclick="addFilter(this.id, 'desktop');">Desktops</div>
            <div class="filterItem" id="console" onclick="addFilter(this.id, 'console');">Gaming Consoles</div>
            <div class="filterItem" id="software" onclick="addFilter(this.id, 'software');">Softwares</div>
            <div class="filterItem" id="accessories" onclick="addFilter(this.id, 'accessories');">Accessories</div>
        </sidebar>
        
		<div id="articles">
		    <div id="articlesHeader">
		        <h2>ALL: <span id="count">3 results</span></h2>
		    </div>
		    <div class="items">
		        <!-- Item 1 -->
		        <div class="item">
		            <img src="img/smartphone.jpg" alt="Smartphone">
		            <h3>Smartphone</h3>
		            <p>$499</p>
		            <button class="add-to-cart">Add to Cart</button>
		        </div>
		        <!-- Item 2 -->
		        <div class="item">
		            <img src="img/laptop.jpg" alt="Laptop">
		            <h3>Laptop</h3>
		            <p>$999</p>
		            <button class="add-to-cart">Add to Cart</button>
		        </div>
		        <!-- Item 3 -->
		        <div class="item">
		            <img src="img/console.jpg" alt="Gaming Console">
		            <h3>Gaming Console</h3>
		            <p>$399</p>
		            <button class="add-to-cart">Add to Cart</button>
		        </div>
				<div class="item">
					<img src="img/console.jpg" alt="Gaming Console">
					<h3>Gaming Console</h3>
					<p>$399</p>
					<button class="add-to-cart">Add to Cart</button>
				</div>
				<div class="item">
					<img src="img/console.jpg" alt="Gaming Console">
					<h3>Gaming Console</h3>
					<p>$399</p>
					<button class="add-to-cart">Add to Cart</button>
				</div>
		    </div>
		</div>

        <script>
			function filterItems() {
			    let input = document.getElementById('search-bar').value.toLowerCase();
			    let items = document.getElementsByClassName('item');
			    let visibleCount = 0; // To track visible items count

			    for (let i = 0; i < items.length; i++) {
			        let item = items[i];
			        let title = item.getElementsByTagName('h3')[0].innerText.toLowerCase();

			        if (title.indexOf(input) > -1) {
			            item.style.display = "";
			            visibleCount++;
			        } else {
			            item.style.display = "none";
			        }
			    }

			    // Update the result count
			    document.getElementById('count').innerText = `${visibleCount} results`;
			}
			function countInitialItems() {
			    let items = document.getElementsByClassName('item'); // Get all items
			    let initialCount = items.length; // Count the items
			    document.getElementById('count').innerText = `${initialCount} results`; // Update the count in the header
			}

			// Call the function when the page loads
			document.addEventListener('DOMContentLoaded', countInitialItems);
			fetch('/api/user')
			    .then(response => response.json())
			    .then(user => {
			        document.getElementById('username').innerText = user.username;
			    });


		</script>
    </div>
</body>
</html>